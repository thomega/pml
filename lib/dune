(library
  (name pml)
  (public_name pml)
  ;;; Adding the following makes dune crash!
  ; (modules
  ;   Discid Discid_C)
  (private_modules
    Discid_C)
  ; (wrapped false)
  (inline_tests)
  (preprocess (pps ppx_inline_test))
  ; (flags (:standard -I +unix))
  ; (ocamlc_flags (:standard))
  (ocamlopt_flags (:standard -inline 32))
  (libraries )
  (ctypes
    (external_library_name libdiscid)
    (build_flags_resolver pkg_config)
    (headers (include "discid/discid.h"))
    (type_description
      (instance Types)
      (functor Discid_C_type_descriptions))
    (function_description
      (concurrency sequential)
      (instance Functions)
      (functor Discid_C_function_descriptions))
    (generated_types Discid_C_types)
    (generated_entry_point Discid_C)))
